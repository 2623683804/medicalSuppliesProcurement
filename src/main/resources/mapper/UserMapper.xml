<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kaiyuan.user.dao.UserMapper">

    <resultMap id="userMap" type="com.kaiyuan.user.entity.SysUser">
        <id property="id" column="ID"/>
        <result property="username" column="username"/>
        <result property="password" column="PASSWORD"/>
        <collection property="roles" ofType="com.kaiyuan.user.entity.SysRole">
            <result column="name" property="name"/>
        </collection>
    </resultMap>
    <select id="findByUserName" parameterType="String"
            resultMap="userMap">
        select u.*
        ,r.name
        from Sys_User u
        LEFT JOIN sys_role_user sru on u.id= sru.Sys_User_id
        LEFT JOIN Sys_Role r on sru.Sys_Role_id=r.id
        where username= #{username}
    </select>

    <select id="findByUserId"  resultType="com.kaiyuan.user.entity.SysUser">
        select *
        from Sys_User
        where username= #{username}
    </select>

    <insert id="addGysUserOne" parameterType="com.kaiyuan.user.entity.SysUser">
		insert into sys_user
		(username,password,status)
		values
		(#{username},#{password},1)
	</insert>

    <insert id="addRole" parameterType="com.kaiyuan.user.entity.SysUser">
		insert into sys_role_user
		(Sys_User_id,Sys_Role_id)
		values
		(#{Sys_User_id},2)
	</insert>

    <insert id="addGysUserTwo"   parameterType="com.kaiyuan.user.entity.SupplieDetails">
		insert into supplie_details
		(companyName,zzjgNumber,tyshNumber,tax_number,account_number,legal_name,legal_number,business_contact,bu_contact_phone,bank,bank_number,address)
		values
		(#{companyName},#{zzjgNumber},#{tyshNumber},#{tax_number},#{account_number},#{legal_name},#{legal_number},#{business_contact},#{bu_contact_phone},#{bank},#{bank_number},#{address})
	</insert>

    <select id="queryGlyid" resultType="com.kaiyuan.user.entity.SupplieDetails">
        select * from supplie_details where companyName=#{companyName}
    </select>

    <update id="updateGysUserSt">
        update sys_user set
        gysid=#{gysid},
        status=2
        where username=#{username}
    </update>




</mapper>